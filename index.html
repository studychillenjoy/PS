<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data Statistics Solver - Dark Mode</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<!-- Chart.js CDN for graphing -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>

<style>
/* --- Permanent Dark Mode Variables --- */
:root {
  --bg: #1f2937; /* Dark background */
  --box: #374151; /* Card background */
  --text: #f9fafb; /* Light text */
  --primary: #60a5fa; /* Primary Blue */
  --primary-hover: #3b82f6;
  --shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
  --input-border: #4b5563;
  --solution-bg: #111827; /* Darker background for results box */
  --accent-green: #34d399; /* Green for success/highlights */
  --error: #f87171;
}

/* --- Global & Responsive Styles --- */
body {
  font-family: "Poppins", sans-serif;
  margin: 0;
  padding: 0;
  background: var(--bg);
  color: var(--text);
  display: flex;
  justify-content: center;
  align-items: flex-start;
  min-height: 100vh;
}

.container {
  width: 95%; /* Fluid width for mobile */
  max-width: 1000px; /* Enhanced max width for laptop */
  margin: 20px auto;
  background: var(--box);
  padding: 20px;
  border-radius: 18px;
  box-shadow: var(--shadow);
  animation: fadeIn 0.7s ease;
}

h1 {
  text-align: center;
  margin-bottom: 25px;
  font-weight: 700;
  font-size: 1.8rem;
  color: var(--primary);
  border-bottom: 3px solid var(--primary);
  padding-bottom: 10px;
}

h2 {
  font-weight: 600;
  margin-top: 25px;
  margin-bottom: 15px;
  color: var(--text);
  border-bottom: 1px solid var(--input-border);
  padding-bottom: 5px;
}

/* Mode Selector Styles */
.mode-selector {
  display: flex;
  margin-bottom: 25px;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
}

.mode-selector button {
  flex-grow: 1;
  padding: 10px;
  border: none;
  background: var(--box);
  color: var(--primary);
  font-weight: 500;
  transition: background 0.3s, color 0.3s;
  box-shadow: none;
  transform: none;
}

.mode-selector button.active {
  background: var(--primary);
  color: white;
  font-weight: 600;
}

/* Input Styles */
input {
  width: 100%;
  padding: 12px;
  border-radius: 10px;
  border: 1px solid var(--input-border);
  background: var(--box);
  color: var(--text);
  font-size: 1rem;
  transition: border-color 0.3s, box-shadow 0.3s;
}

input:focus, textarea:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 4px rgba(96, 165, 250, 0.2);
  outline: none;
}

button {
  background: var(--primary);
  border: none;
  color: white;
  padding: 12px 22px;
  border-radius: 10px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.3s, transform 0.1s, box-shadow 0.3s;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

button:hover {
  background: var(--primary-hover);
  transform: translateY(-2px);
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
}

#grouped-input-container button:last-child, #ungrouped-input-container button:last-child {
    margin-top: 20px;
    width: 100%;
}

/* Base input box styles */
.input-box {
  display: flex;
  gap: 10px;
  margin-bottom: 0px;
}
.input-group-header {
  display: flex;
  gap: 10px;
  font-weight: 600;
  margin-bottom: 8px;
  color: var(--text);
  padding-left: 12px;
}

/* --- Grouped Data Specifics (3 columns) --- */
#grouped-input-container .input-group-header > div {
  flex: 1; 
}
#grouped-input-container .input-box {
    display: flex;
}

/* --- Discrete Data Specifics (2 columns) --- */
#ungrouped-input-container .discrete-header {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    font-weight: 600;
    margin-bottom: 8px;
    color: var(--text);
    padding-left: 12px;
}
#ungrouped-input-container .input-box {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
}


/* Results Grid */
#results {
  margin-top: 40px;
  padding: 25px;
  background: var(--solution-bg);
  border-radius: 15px;
  border: 1px solid var(--primary);
  box-shadow: 0 4px 15px rgba(96, 165, 250, 0.2);
  display: none;
}

.solution-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.solution-item {
    background: var(--box);
    padding: 15px;
    border-radius: 10px;
    text-align: center;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

.solution-item p {
    font-size: 0.9rem;
    color: var(--primary);
    margin: 0 0 5px 0;
}

.solution-item b {
  display: block;
  font-size: 1.8rem;
  font-weight: 700;
  color: var(--accent-green);
}

/* Chart Container Styling */
#chart-container {
  max-width: 900px;
  margin: 0 auto;
  padding-top: 10px;
  height: 400px; /* Default height for laptop/desktop */
}

/* --- Notification Box (Improved) --- */
#notif {
    position: fixed;
    bottom: 20px;
    right: 20px;
    padding: 12px 20px;
    border-radius: 10px;
    color: white;
    font-weight: 600;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    z-index: 1000;
    display: none;
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.3s ease-out, transform 0.3s ease-out;
}
#notif.show {
    opacity: 1;
    transform: translateY(0);
}


/* Desktop optimization (min-width: 768px) */
@media (min-width: 768px) {
    .container {
        padding: 30px; /* More padding on desktop */
        margin: 40px auto; /* Better vertical centering/spacing */
    }
}


/* Mobile Responsiveness (max-width: 640px) */
@media (max-width: 640px) {
  
  /* --- Grouped Data: Stack Vertically for 3 inputs --- */
  #grouped-input-container .input-box {
    flex-direction: column;
    gap: 15px;
  }
  
  /* --- Discrete Data: Keep 2-column grid but hide header --- */
  #ungrouped-input-container .input-box {
      gap: 10px;
  }

  /* Hide column headers on mobile for all input types */
  .input-group-header, .discrete-header {
    display: none;
  }
  
  /* General mobile refinements */
  h1 { font-size: 1.5rem; }
  .container { padding: 15px; margin: 10px auto; }
  .solution-grid { grid-template-columns: 1fr; }
  .solution-item { padding: 12px; }
  .solution-item b { font-size: 1.5rem; }
  #chart-container { height: 300px; }
}

/* Animations */
@keyframes fadeIn {
  from {opacity: 0; transform: translateY(20px);}
  to {opacity: 1; transform: translateY(0);}
}
</style>
</head>
<body>

<div id="notif"></div>

<div class="container">
  <h1>ðŸ“Š Data Statistics Solver</h1>

  <!-- Mode Selector -->
  <div class="mode-selector">
      <button id="mode-grouped" class="active" onclick="switchMode('grouped')">Grouped Data (Intervals)</button>
      <button id="mode-ungrouped" onclick="switchMode('ungrouped')">Discrete Data (Value/Freq)</button>
  </div>

  <!-- Grouped Data Input -->
  <div id="grouped-input-container">
    <label for="num">Enter Number of Class Intervals:</label>
    <div class="input-box">
      <input type="number" id="num" min="1" placeholder="e.g., 5">
      <button onclick="step2Grouped()">Generate Input Fields</button>
    </div>
    <div id="step2-grouped"></div>
  </div>
  
  <!-- Discrete Data Input (Ungrouped) -->
  <div id="ungrouped-input-container" style="display: none;">
      <label for="discrete-num">Enter Number of Data/Frequency Pairs:</label>
      <div class="input-box">
        <input type="number" id="discrete-num" min="1" placeholder="e.g., 5 unique values">
        <button onclick="step2Discrete()">Generate Input Fields</button>
      </div>
      <div id="step2-discrete"></div>
  </div>
  
  <div id="results">
    <h2>Final Measures</h2>
    <div class="solution-grid">
      <!-- Central Tendency -->
      <div class="solution-item">
        <p>Mean ($\bar{x}$):</p>
        <b id="mean-result">...</b>
      </div>
      <div class="solution-item">
        <p>Median:</p>
        <b id="median-result">...</b>
      </div>
      <div class="solution-item">
        <p>Mode:</p>
        <b id="mode-result">...</b>
      </div>
      <!-- Dispersion Measures -->
      <div class="solution-item">
        <p>Variance ($s^2$):</p>
        <b id="variance-result">...</b>
      </div>
      <div class="solution-item">
        <p>Std. Dev. ($s$):</p>
        <b id="stddev-result">...</b>
      </div>
    </div>
    
    <h2 style="margin-top: 30px;">Frequency Distribution Chart</h2>
    <div id="chart-container">
        <canvas id="freqChart"></canvas>
    </div>
  </div>
</div>

<script>
let L=[],U=[],F_grouped=[],cf=[],mid=[], V=[], F_discrete=[]; 
let mean, median, mode, variance, stdDev, total=0;
let currentMode='grouped';
let freqChartInstance = null; 

/* --- Utility Functions --- */

function notify(msg, isError = false){
  let n=document.getElementById("notif");
  n.innerHTML=msg;
  n.style.backgroundColor = isError ? "var(--error)" : "var(--accent-green)";

  n.classList.remove('show');
  n.style.display="block";
  setTimeout(() => {
      n.classList.add('show');
  }, 10); 

  setTimeout(()=>{
      n.classList.remove('show');
      setTimeout(() => {
          n.style.display="none";
      }, 300); 
  },4000);
}

/**
 * Toggles the input and calculation mode between 'grouped' and 'ungrouped' (discrete).
 */
function switchMode(mode) {
    currentMode = mode;
    document.getElementById('grouped-input-container').style.display = mode === 'grouped' ? 'block' : 'none';
    document.getElementById('ungrouped-input-container').style.display = mode === 'ungrouped' ? 'block' : 'none';

    document.getElementById('mode-grouped').classList.toggle('active', mode === 'grouped');
    document.getElementById('mode-ungrouped').classList.toggle('active', mode === 'ungrouped');
    
    document.getElementById("results").style.display="none";
    if (freqChartInstance) {
        freqChartInstance.destroy();
        freqChartInstance = null;
    }
}

/* --- Input & Auto-Focus Handlers --- */

/**
 * Handles 'Enter' key press for Grouped Data (L, U, F).
 */
function handleGroupedInputKeydown(event, type, index, totalN) {
    if (event.key === 'Enter') {
        event.preventDefault(); 
        let nextElementId;
        let nextIndex = index;

        if (type === 'l') {
            nextElementId = 'u' + index; // L -> U (same row)
        } else if (type === 'u') {
            nextElementId = 'f' + index; // U -> F (same row)
        } else if (type === 'f') {
            nextIndex++;
            nextElementId = 'l' + nextIndex; // F -> L (next row)
        }

        let nextElement = document.getElementById(nextElementId);
        
        if (nextElement) {
            nextElement.focus();
        } else if (type === 'f' && nextIndex === totalN) {
            // Reached the end of the last row's frequency field
            document.querySelector('#grouped-input-container button[onclick="calculate()"]').focus();
        }
    }
}

/**
 * Handles 'Enter' key press for Discrete Data (Value, Freq).
 */
function handleDiscreteInputKeydown(event, type, index, totalN) {
    if (event.key === 'Enter') {
        event.preventDefault(); 
        let nextElementId;
        let nextIndex = index;

        if (type === 'v') {
            nextElementId = 'f_d' + index; // V -> F (same row)
        } else if (type === 'f_d') {
            nextIndex++;
            nextElementId = 'v' + nextIndex; // F -> V (next row)
        }

        let nextElement = document.getElementById(nextElementId);
        
        if (nextElement) {
            nextElement.focus();
        } else if (type === 'f_d' && nextIndex === totalN) {
            // Reached the end of the last row's frequency field
            document.querySelector('#ungrouped-input-container button[onclick="calculate()"]').focus();
        }
    }
}


/**
 * Generates the input fields for grouped data based on the number of intervals.
 */
function step2Grouped(){
  let n=parseInt(document.getElementById("num").value);
  if(isNaN(n) || n<1){notify("Enter a valid number of intervals (1 or more)!", true);return;}

  let html="<h2>Input Data (Class Intervals)</h2>";
  html+=`<div class='input-group-header'><div>Lower Limit</div><div>Upper Limit</div><div>Frequency</div></div>`;
  for(let i=0;i<n;i++){
    html+=`
    <div class='input-box'>
      <input placeholder='Lower Limit' id='l${i}' type='number' value='${L[i] || ''}' required onkeydown="handleGroupedInputKeydown(event, 'l', ${i}, ${n})">
      <input placeholder='Upper Limit' id='u${i}' type='number' value='${U[i] || ''}' required onkeydown="handleGroupedInputKeydown(event, 'u', ${i}, ${n})">
      <input placeholder='Frequency' id='f${i}' type='number' value='${F_grouped[i] || ''}' required onkeydown="handleGroupedInputKeydown(event, 'f', ${i}, ${n})">
    </div>`;
  }
  html+=`<button onclick="calculate()">Calculate Statistics</button>`;
  document.getElementById("step2-grouped").innerHTML=html;
  
  document.getElementById("results").style.display="none";
  if (freqChartInstance) { freqChartInstance.destroy(); freqChartInstance = null; }
}

/**
 * Generates the input fields for discrete (value/frequency) data.
 */
function step2Discrete(){
  let n=parseInt(document.getElementById("discrete-num").value);
  if(isNaN(n) || n<1){notify("Enter a valid number of pairs (1 or more)!", true);return;}

  let html="<h2>Input Data (Value/Frequency)</h2>";
  html+=`<div class='discrete-header'><div>Value (x)</div><div>Frequency (f)</div></div>`;
  for(let i=0;i<n;i++){
    html+=`
    <div class='input-box'>
      <input placeholder='Value (x)' id='v${i}' type='number' value='${V[i] || ''}' required onkeydown="handleDiscreteInputKeydown(event, 'v', ${i}, ${n})">
      <input placeholder='Frequency (f)' id='f_d${i}' type='number' value='${F_discrete[i] || ''}' required onkeydown="handleDiscreteInputKeydown(event, 'f_d', ${i}, ${n})">
    </div>`;
  }
  html+=`<button onclick="calculate()">Calculate Statistics</button>`;
  document.getElementById("step2-discrete").innerHTML=html;
  
  document.getElementById("results").style.display="none";
  if (freqChartInstance) { freqChartInstance.destroy(); freqChartInstance = null; }
}

/* --- Calculation Logic --- */

function calculate() {
    clearResults();
    if (currentMode === 'grouped') {
        calculateGroupedData();
    } else {
        calculateDiscreteData();
    }
}

function clearResults() {
    // Resetting global variables
    L=[],U=[],F_grouped=[],cf=[],mid=[], V=[], F_discrete=[], total=0;
    
    // Clear display
    document.getElementById("mean-result").innerHTML = '...';
    document.getElementById("median-result").innerHTML = '...';
    document.getElementById("mode-result").innerHTML = '...';
    document.getElementById("variance-result").innerHTML = '...';
    document.getElementById("stddev-result").innerHTML = '...';
    document.getElementById("results").style.display="none";

    if (freqChartInstance) { 
        freqChartInstance.destroy(); 
        freqChartInstance = null; 
    }
}

function calculateGroupedData(){
  let n=parseInt(document.getElementById("num").value);
  L=[],U=[],F_grouped=[],mid=[],cf=[],total=0;
  
  // 1. Data Collection and Midpoint/Total Frequency
  for(let i=0;i<n;i++){
    let l_val = parseFloat(document.getElementById("l"+i).value);
    let u_val = parseFloat(document.getElementById("u"+i).value);
    let f_val = parseInt(document.getElementById("f"+i).value);
    
    if(isNaN(l_val) || isNaN(u_val) || isNaN(f_val) || f_val < 0) {
      notify("Please enter valid numbers for all Grouped Data fields. Frequency must be non-negative.", true);
      return;
    }
    if(l_val >= u_val) {
        notify(`Error in row ${i+1}: Lower limit must be strictly less than Upper limit.`, true);
        return;
    }

    L.push(l_val);
    U.push(u_val);
    F_grouped.push(f_val);
    total+=F_grouped[i];
    mid.push((L[i]+U[i])/2);
  }
  if(total==0){notify("Total frequency cannot be zero!", true);return;}

  // 2. Mean Calculation (using midpoints)
  let sum_f_x = mid.reduce((s,v,i)=>s+v*F_grouped[i],0);
  mean = sum_f_x/total;
  
  // 3. Median Calculation
  cf[0]=F_grouped[0];for(let i=1;i<n;i++)cf[i]=cf[i-1]+F_grouped[i];
  let half=total/2, mc=-1;
  for(let i=0; i<n; i++) {if (cf[i] >= half) {mc = i; break;}}
  
  if (mc !== -1) {
      let L_m = L[mc];
      let F_m = F_grouped[mc];
      let h_m = U[mc] - L[mc];
      let C_f = mc === 0 ? 0 : cf[mc-1];
      median = L_m + ((half - C_f) / F_m) * h_m;
  } else { median = NaN; }

  // 4. Mode Calculation
  let max_f = Math.max(...F_grouped);
  let mc2_indices = F_grouped.map((val, index) => val === max_f ? index : -1).filter(index => index !== -1);
  let mc2 = mc2_indices[0]; 
  
  if (mc2 !== undefined) {
      let f1=F_grouped[mc2];
      let f0=mc2===0?0:F_grouped[mc2-1];
      let f2=mc2===n-1?0:F_grouped[mc2+1];
      let h_mode = U[mc2] - L[mc2];
      let denominator = 2*f1-f0-f2;

      if (denominator === 0) { 
          mode = (L[mc2] + U[mc2]) / 2;
      } else {
          mode = L[mc2] + ((f1-f0)/denominator) * h_mode;
      }
  } else { mode = NaN; }
  
  // 5. Variance and Standard Deviation Calculation (Sample Variance)
  let sum_f_d_squared = 0;

  for(let i = 0; i < n; i++) {
      let deviation = mid[i] - mean;
      sum_f_d_squared += F_grouped[i] * Math.pow(deviation, 2); 
  }

  variance = (total > 1) ? sum_f_d_squared / (total - 1) : 0;
  stdDev = Math.sqrt(variance);
  
  // 6. Render Chart and Results
  // Labels for Frequency Polygon should be the midpoints
  const labels = mid.map(m => m.toFixed(1)); 
  renderChart('line', labels, F_grouped, 'Grouped Data Frequency Polygon', 'Class Midpoints (x)');
  displayResults(mean, median, mode, variance, stdDev);
  notify("Grouped Data Calculation Complete. Results and Chart displayed below.");
}

function calculateDiscreteData() {
    let n = parseInt(document.getElementById("discrete-num").value);
    V = [], F_discrete = [], total = 0;

    // 1. Data Collection and Total Frequency
    for (let i = 0; i < n; i++) {
        let v_val = parseFloat(document.getElementById("v" + i).value);
        let f_val = parseInt(document.getElementById("f_d" + i).value);

        if (isNaN(v_val) || isNaN(f_val) || f_val < 0) {
            notify("Please ensure Value is a number and Frequency is a non-negative integer.", true);
            return;
        }
        
        // Temporarily store data for duplication check and sorting
        V.push(v_val);
        F_discrete.push(f_val);
        total += f_val;
    }

    if (total === 0) {
        notify("Total frequency must be greater than zero!", true);
        return;
    }
    
    // Check for duplicates in values
    const uniqueValues = new Set(V);
    if (uniqueValues.size !== V.length) {
        notify(`Error: Duplicate data values were entered. Please list unique values only.`, true);
        return;
    }


    // Sort by value (important for median)
    const sortedPairs = V.map((v, i) => ({ v, f: F_discrete[i] })).sort((a, b) => a.v - b.v);
    V = sortedPairs.map(p => p.v);
    F_discrete = sortedPairs.map(p => p.f);
    n = V.length; // Update n in case of sorting/filtering (though filtering is handled by error check)


    // 2. Mean: Sum(x*f) / Sum(f)
    const sum_v_f = V.reduce((s, v, i) => s + v * F_discrete[i], 0);
    mean = sum_v_f / total;

    // 3. Median (using cumulative frequency)
    let cf_d = [];
    cf_d[0] = F_discrete[0];
    for (let i = 1; i < n; i++) cf_d[i] = cf_d[i - 1] + F_discrete[i];

    const half = total / 2; 
    let medianValue = NaN;

    if (total % 2 !== 0) {
         // Odd total: median is the value corresponding to the (total+1)/2 position
         const pos = (total + 1) / 2;
         for (let i = 0; i < n; i++) {
             if (cf_d[i] >= pos) {
                medianValue = V[i];
                break;
            }
        }
    } else {
        // Even total: median is the average of values at total/2 and total/2 + 1 positions
        const pos1 = total / 2;
        const pos2 = total / 2 + 1;
        
        let val1 = null;
        let val2 = null;

        for (let i = 0; i < n; i++) {
            if (cf_d[i] >= pos1 && val1 === null) {
                val1 = V[i];
            }
            if (cf_d[i] >= pos2 && val2 === null) {
                val2 = V[i];
                break;
            }
        }
        
        if (val1 !== null && val2 !== null) {
            medianValue = (val1 + val2) / 2;
        }
    }
    median = medianValue;
    
    // 4. Mode: Value(s) with the highest frequency
    let maxFreq = Math.max(...F_discrete);
    let modeValues = V.filter((v, i) => F_discrete[i] === maxFreq);

    // If all frequencies are the same, there is no mode.
    const uniqueFreqs = new Set(F_discrete).size;
    let modeString;

    if (uniqueFreqs === 1) {
        modeString = 'N/A (Uniform)';
    } else {
        modeString = modeValues.join(', ');
    }

    // 5. Variance and Standard Deviation (Sample Variance)
    let sumOfSquaredDeviations = 0;
    for (let i = 0; i < n; i++) {
        let deviation = V[i] - mean;
        sumOfSquaredDeviations += F_discrete[i] * Math.pow(deviation, 2);
    }
    
    variance = (total > 1) ? sumOfSquaredDeviations / (total - 1) : 0;
    stdDev = Math.sqrt(variance);

    // 6. Render Chart and Results
    renderChart('line', V, F_discrete, 'Discrete Data Frequency Line Graph', 'Data Values (x)');
    displayResults(mean, median, modeString, variance, stdDev);
    notify("Discrete Data Calculation Complete. Results and Chart displayed below.");
}


/* --- Result Display & Charting --- */

function displayResults(m, med, mod, v, sd) {
    document.getElementById("results").style.display="block";
    document.getElementById("mean-result").innerHTML = isNaN(m) ? 'N/A' : m.toFixed(4);
    document.getElementById("median-result").innerHTML = isNaN(med) ? 'N/A' : med.toFixed(4);
    document.getElementById("mode-result").innerHTML = mod; 
    document.getElementById("variance-result").innerHTML = isNaN(v) ? 'N/A' : v.toFixed(4);
    document.getElementById("stddev-result").innerHTML = isNaN(sd) ? 'N/A' : sd.toFixed(4);
}

function renderChart(type, labels, data, title, xLabel) {
    const ctx = document.getElementById('freqChart').getContext('2d');
    
    if (freqChartInstance) {
        freqChartInstance.destroy();
    }
    
    freqChartInstance = new Chart(ctx, {
        type: type, // Now dynamically set ('line' for both modes)
        data: {
            labels: labels,
            datasets: [{
                label: 'Frequency (f)',
                data: data,
                // UI IMPROVEMENT: Line styling for better aesthetics
                backgroundColor: 'rgba(96, 165, 250, 0.2)', // Light fill below the line
                borderColor: 'var(--primary)', // Main line color
                borderWidth: 3, // Thicker line
                tension: 0.4, // Smoother curve (Bezier)
                fill: 'origin', // Fill area under the line
                pointBackgroundColor: 'var(--accent-green)', // Highlight points
                pointBorderColor: 'var(--box)',
                pointBorderWidth: 2,
                pointRadius: 6, // Larger points
                pointHoverRadius: 8
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Frequency (f)',
                        color: 'var(--text)'
                    },
                    grid: { color: 'var(--input-border)' },
                    ticks: { color: 'var(--text)' }
                },
                x: {
                    title: {
                        display: true,
                        text: xLabel,
                        color: 'var(--text)'
                    },
                    grid: { display: false },
                    ticks: { color: 'var(--text)' }
                }
            },
            plugins: {
                legend: {
                    display: false
                },
                title: {
                    display: true,
                    text: title,
                    color: 'var(--text)',
                    font: { size: 16 }
                },
                tooltip: { // UI IMPROVEMENT: Modern tooltip styling
                    backgroundColor: 'var(--solution-bg)',
                    titleColor: 'var(--primary)',
                    bodyColor: 'var(--text)',
                    borderColor: 'var(--primary)',
                    borderWidth: 1,
                    cornerRadius: 8,
                    padding: 12,
                    displayColors: false
                }
            }
        }
    });
}

// Initialize mode on load
window.onload = () => {
    switchMode('grouped');
}
</script>

</body>
</html>
